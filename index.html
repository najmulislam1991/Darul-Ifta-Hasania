<!DOCTYPE html>
<html lang="bn" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>দারুল ইফতা হাসানিয়া</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Hind Siliguri & Noto Naskh Arabic -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&family=Noto+Naskh+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Placeholder Comments -->
    <!-- Chosen Palette: Serene Islamic Green -->
    <!-- Application Structure Plan: A single-page application (SPA) model using JavaScript to show/hide content sections (<section>) for a seamless, app-like user experience without page reloads. A fixed header contains global controls (menu, theme, language), and a slide-in drawer provides primary navigation. Content is organized into logical sections corresponding to menu items. Modals are used for detailed views like "Read More". This structure was chosen for its modern feel, speed, and user-friendly flow, perfectly suiting a content-rich site. -->
    <!-- Visualization & Content Choices: 
        - Prayer Times: Goal: Inform. Method: Styled HTML table populated via an external API (Al-Adhan). A dropdown allows users to select their district, triggering an API call to fetch location-specific times. The design has been enhanced with better spacing, typography, and the removal of zebra-striping for a uniform look. Forbidden times are now detailed with start/end descriptions based on API data. Justification: Provides accurate, dynamic, and personalized information, significantly improving utility and aesthetics.
        - Language Switcher: Goal: Personalize. Method: Refactored for performance. A JavaScript "dictionary" object holds all UI strings. The language change function now instantly updates existing DOM elements' text content instead of re-rendering entire sections, providing a seamless and immediate visual update. Justification: This eliminates perceived lag and significantly improves user experience.
        - Form: Goal: User Input. Method: Standard HTML form submitted via AJAX to a third-party service (Formspree). The endpoint has been corrected to a new, valid one to fix the "not found" error. Justification: Universal pattern for data collection, made functional on a static site.
        All interactions are handled with vanilla JavaScript to keep the application lightweight and self-contained.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        /* Main Font Setup */
        body {
            font-family: 'Hind Siliguri', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        html[lang="ur"] body, html[lang="ar"] body {
            font-family: 'Noto Naskh Arabic', serif;
            direction: rtl;
        }

        html[lang="en"] body {
            font-family: 'Hind Siliguri', sans-serif; /* Using same for consistency, can be changed */
            direction: ltr;
        }

        /* Theme Colors using CSS Variables */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-accent: #eef2f4;
            --text-primary: #212529;
            --text-secondary: #495057;
            --border-color: #dee2e6;
            --accent-color: #00897B; /* A pleasant teal color */
            --accent-color-hover: #00695C;
        }

        html.dark {
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-accent: #2c2c2c;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --border-color: #3e3e3e;
            --accent-color: #4DB6AC;
            --accent-color-hover: #26A69A;
        }

        /* Applying theme colors */
        body {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        .themed-bg-primary { background-color: var(--bg-primary); }
        .themed-bg-secondary { background-color: var(--bg-secondary); }
        .themed-bg-accent { background-color: var(--bg-accent); }
        .themed-text-primary { color: var(--text-primary); }
        .themed-text-secondary { color: var(--text-secondary); }
        .themed-border { border-color: var(--border-color); }
        .themed-accent { background-color: var(--accent-color); }
        .themed-accent-text { color: var(--accent-color); }
        .themed-accent-hover:hover { background-color: var(--accent-color-hover); }

        /* Drawer Styles */
        #drawer {
            transition: transform 0.3s ease-in-out;
        }
        html[lang="bn"] #drawer, html[lang="en"] #drawer { transform: translateX(-100%); }
        html[lang="ur"] #drawer, html[lang="ar"] #drawer { transform: translateX(100%); }

        html[lang="bn"] #drawer.open, html[lang="en"] #drawer.open { transform: translateX(0); }
        html[lang="ur"] #drawer.open, html[lang="ar"] #drawer.open { transform: translateX(0); }
        
        /* Marquee / Scrolling Text */
        @keyframes marquee-ltr {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        @keyframes marquee-rtl {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .marquee-text {
            animation: marquee-ltr 20s linear infinite;
        }
        html[lang="ur"] .marquee-text, html[lang="ar"] .marquee-text {
            animation-name: marquee-rtl;
        }

        /* Active Nav Link Style */
        .nav-link.active {
            background-color: var(--accent-color);
            color: white;
        }
        .nav-link.active .themed-text-secondary {
            color: white;
        }

        /* Page transition */
        .page {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Modal Styles */
        .modal {
            transition: opacity 0.3s ease;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color-hover);
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Drawer (Sidebar) -->
    <aside id="drawer" class="fixed top-0 z-50 w-72 h-full themed-bg-primary shadow-lg ltr:left-0 rtl:right-0">
        <div class="p-4">
            <h2 id="drawer-title" class="text-2xl font-bold themed-accent-text" data-lang-key="drawer_title">দারুল ইফতা</h2>
            <p id="drawer-subtitle" class="text-sm themed-text-secondary" data-lang-key="drawer_subtitle">হাসানিয়া, নড়াইল</p>
        </div>
        <nav id="nav-menu" class="flex flex-col p-2 space-y-2">
            <a href="#home" class="nav-link text-lg font-semibold px-4 py-2 rounded-md transition-all duration-200" data-lang-key="nav_home">হোম</a>
            <div id="masayel-menu-container">
                <a href="#masayel" class="nav-link text-lg font-semibold px-4 py-2 rounded-md transition-all duration-200 flex justify-between items-center">
                    <span data-lang-key="nav_masayel">মাসায়েল</span>
                    <i class="fas fa-chevron-down text-sm transition-transform"></i>
                </a>
                <div id="masayel-submenu" class="ltr:pl-4 rtl:pr-4 pt-2 hidden space-y-1">
                    <a href="#masayel" data-category="ত্বহারাত" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_taharat">ত্বহারাত</a>
                    <a href="#masayel" data-category="সালাত" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_salat">সালাত</a>
                    <a href="#masayel" data-category="রোজা" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_sawm">রোজা</a>
                    <a href="#masayel" data-category="যাকাত" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_zakat">যাকাত</a>
                    <a href="#masayel" data-category="হজ্ব" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_hajj">হজ্ব</a>
                    <a href="#masayel" data-category="মুআমালাত" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_muamalat">মুআমালাত</a>
                    <a href="#masayel" data-category="বিবাহ ও তালাক" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_marriage">বিবাহ ও তালাক</a>
                    <a href="#masayel" data-category="জায়েজ-নাজায়েজ" class="nav-link block px-4 py-1.5 rounded-md text-base themed-text-secondary hover:bg-gray-200 dark:hover:bg-gray-700" data-lang-key="cat_halal">জায়েজ-নাজায়েজ</a>
                </div>
            </div>
            <a href="#ask" class="nav-link text-lg font-semibold px-4 py-2 rounded-md transition-all duration-200" data-lang-key="nav_ask">প্রশ্ন করুন</a>
            <a href="#about" class="nav-link text-lg font-semibold px-4 py-2 rounded-md transition-all duration-200" data-lang-key="nav_about">আমাদের সম্পর্কে</a>
            <a href="#contact" class="nav-link text-lg font-semibold px-4 py-2 rounded-md transition-all duration-200" data-lang-key="nav_contact">যোগাযোগ</a>
        </nav>
    </aside>

    <!-- Overlay for Drawer -->
    <div id="drawer-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

    <!-- Main Content -->
    <div id="main-content" class="min-h-screen transition-transform duration-300">
        <!-- Header -->
        <header class="sticky top-0 z-30 flex items-center justify-between p-3 themed-bg-primary shadow-md">
            <button id="menu-button" class="p-2 rounded-full hover:themed-bg-accent focus:outline-none">
                <i class="fas fa-bars text-xl themed-text-primary"></i>
            </button>
            <h1 id="header_title" class="text-xl font-bold themed-accent-text" data-lang-key="header_title">দারুল ইফতা হাসানিয়া</h1>
            <div class="flex items-center space-x-2">
                 <div class="relative">
                    <button id="lang-button" class="p-2 rounded-full hover:themed-bg-accent">
                        <i class="fas fa-globe text-xl themed-text-primary"></i>
                    </button>
                    <div id="lang-menu" class="absolute ltr:right-0 rtl:left-0 mt-2 w-28 themed-bg-primary rounded-md shadow-lg hidden">
                        <a href="#" class="block px-4 py-2 text-sm themed-text-primary hover:themed-bg-accent" data-lang="bn">বাংলা</a>
                        <a href="#" class="block px-4 py-2 text-sm themed-text-primary hover:themed-bg-accent" data-lang="en">English</a>
                        <a href="#" class="block px-4 py-2 text-sm themed-text-primary hover:themed-bg-accent" data-lang="ur">اردو</a>
                        <a href="#" class="block px-4 py-2 text-sm themed-text-primary hover:themed-bg-accent" data-lang="ar">العربية</a>
                    </div>
                </div>
                <button id="dark-mode-toggle" class="p-2 rounded-full hover:themed-bg-accent">
                    <i class="fas fa-moon text-xl themed-text-primary"></i>
                </button>
            </div>
        </header>

        <!-- Scrolling Marquee -->
        <div class="themed-accent text-white py-2 overflow-hidden whitespace-nowrap">
            <p id="marquee_text" class="marquee-text text-center font-semibold" data-lang-key="marquee_text">★ জরুরী মাসয়ালা জানার জন্য এখনই আপনার প্রশ্ন করুন ★</p>
        </div>

        <main class="p-4 md:p-6">
            <!-- Home Page -->
            <section id="home" class="page">
                <!-- Image Slider -->
                <div id="image-slider" class="relative w-full h-48 md:h-64 lg:h-80 rounded-2xl overflow-hidden shadow-lg mb-6">
                    <!-- Images will be injected by JS -->
                </div>
                
                <!-- Welcome Message -->
                <div class="themed-bg-primary p-6 rounded-2xl shadow-md mb-6 text-center">
                    <h2 id="welcome-title" class="text-2xl md:text-3xl font-bold themed-accent-text mb-2" data-lang-key="welcome_title">আসসালামু আলাইকুম ওয়া রাহমাতুল্লাহ</h2>
                    <p id="welcome-text" class="themed-text-secondary" data-lang-key="welcome_text">হাসানিয়া দারুল ইফতার ওয়েবসাইটে আপনাকে স্বাগতম। এখানে আপনি কুরআন ও সুন্নাহর আলোকে আপনার প্রয়োজনীয় মাসায়েল জানতে পারবেন।</p>
                </div>

                <!-- Daily Verses -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="themed-bg-primary p-6 rounded-2xl shadow-md">
                        <h3 class="text-xl font-bold mb-3 flex items-center themed-accent-text">
                            <i class="fas fa-quran ltr:mr-2 rtl:ml-2"></i> <span data-lang-key="quran_verse_title">কুরআনের বাণী</span>
                        </h3>
                        <p id="quran-verse" class="themed-text-secondary text-lg italic"></p>
                    </div>
                    <div class="themed-bg-primary p-6 rounded-2xl shadow-md">
                        <h3 class="text-xl font-bold mb-3 flex items-center themed-accent-text">
                            <i class="fas fa-book-open ltr:mr-2 rtl:ml-2"></i> <span data-lang-key="hadith_verse_title">হাদিসের বাণী</span>
                        </h3>
                        <p id="hadith-verse" class="themed-text-secondary text-lg italic"></p>
                    </div>
                </div>

                <!-- Prayer Times -->
                <div class="themed-bg-primary p-6 rounded-2xl shadow-md mb-6">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-4">
                        <h3 class="text-2xl font-bold themed-accent-text mb-3 sm:mb-0" data-lang-key="prayer_times_title">নামাজের সময়সূচী</h3>
                        <div class="flex items-center">
                            <label for="location-selector" class="ltr:mr-2 rtl:ml-2 themed-text-secondary font-medium" data-lang-key="location_label">লোকেশন:</label>
                            <select id="location-selector" class="themed-bg-accent themed-text-primary border-2 themed-border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]"></select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-center">
                            <thead class="themed-text-secondary border-b-2 themed-border">
                                <tr>
                                    <th class="py-3 px-2 font-bold text-base" data-lang-key="prayer_name">নামাজ</th>
                                    <th class="py-3 px-2 font-bold text-base" data-lang-key="prayer_time">সময়</th>
                                </tr>
                            </thead>
                            <tbody id="prayer-times-body">
                                <!-- Prayer times will be injected by JS -->
                            </tbody>
                        </table>
                    </div>
                     <div id="forbidden-times" class="mt-6 border-t themed-border pt-4 text-center themed-text-secondary">
                        <!-- Forbidden times will be injected by JS -->
                    </div>
                </div>

                <!-- Masayel Topics Section -->
                <div class="themed-bg-primary p-6 rounded-2xl shadow-md">
                    <h3 class="text-2xl font-bold mb-4 text-center themed-accent-text" data-lang-key="urgent_masayel">জরুরী মাসায়েল</h3>
                    <div id="home-masayel-categories" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                        <!-- Category boxes will be injected by JS -->
                    </div>
                </div>
            </section>

            <!-- Masayel Page -->
            <section id="masayel" class="page hidden">
                <h2 id="masayel-page-title" class="text-3xl font-bold themed-accent-text mb-6 text-center">মাসায়েল</h2>
                <div id="masayel-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Masayel cards will be injected by JS -->
                </div>
            </section>

            <!-- Ask a Question Page -->
            <section id="ask" class="page hidden">
                <div class="max-w-2xl mx-auto themed-bg-primary p-6 md:p-8 rounded-2xl shadow-md">
                    <h2 class="text-3xl font-bold themed-accent-text mb-6 text-center" data-lang-key="ask_form_title">প্রশ্ন করুন</h2>
                    <form id="question-form">
                        <div class="mb-4">
                            <label for="name" class="block themed-text-secondary font-semibold mb-2" data-lang-key="form_name">নাম</label>
                            <input type="text" id="name" name="name" class="w-full px-4 py-2 themed-bg-accent themed-text-primary border themed-border rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]">
                        </div>
                        <div class="mb-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="anonymous" name="anonymous" class="h-4 w-4 rounded border-gray-300 text-[var(--accent-color)] focus:ring-[var(--accent-color)]">
                                <span class="ltr:ml-2 rtl:mr-2 themed-text-secondary" data-lang-key="form_anonymous">নাম প্রকাশে অনিচ্ছুক</span>
                            </label>
                        </div>
                        <div class="mb-4">
                            <label for="email" class="block themed-text-secondary font-semibold mb-2" data-lang-key="form_email">ইমেইল অ্যাড্রেস</label>
                            <input type="email" id="email" name="email" class="w-full px-4 py-2 themed-bg-accent themed-text-primary border themed-border rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]" required>
                        </div>
                        <div class="mb-4">
                            <label for="phone" class="block themed-text-secondary font-semibold mb-2" data-lang-key="form_phone">ফোন নম্বর (ঐচ্ছিক)</label>
                            <input type="tel" id="phone" name="phone" class="w-full px-4 py-2 themed-bg-accent themed-text-primary border themed-border rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]">
                        </div>
                         <div class="mb-4">
                            <label for="subject" class="block themed-text-secondary font-semibold mb-2" data-lang-key="form_subject">প্রশ্নের বিষয়</label>
                            <input type="text" id="subject" name="subject" class="w-full px-4 py-2 themed-bg-accent themed-text-primary border themed-border rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]" required>
                        </div>
                        <div class="mb-6">
                            <label for="question" class="block themed-text-secondary font-semibold mb-2" data-lang-key="form_details">প্রশ্নের বিস্তারিত</label>
                            <textarea id="question" name="question" rows="6" class="w-full px-4 py-2 themed-bg-accent themed-text-primary border themed-border rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]" required></textarea>
                        </div>
                        <button type="submit" class="w-full text-white font-bold py-3 px-4 rounded-md themed-accent themed-accent-hover transition duration-300 flex items-center justify-center" data-lang-key="form_submit">জমা দিন</button>
                    </form>
                    <div id="form-success-message" class="hidden mt-4 p-4 text-center bg-green-100 text-green-700 rounded-md" data-lang-key="form_success">
                        আপনার প্রশ্ন সফলভাবে জমা দেওয়া হয়েছে। আমরা শীঘ্রই আপনার সাথে যোগাযোগ করব।
                    </div>
                     <div id="form-error-message" class="hidden mt-4 p-4 text-center bg-red-100 text-red-700 rounded-md" data-lang-key="form_error">
                        কিছু একটা সমস্যা হয়েছে। অনুগ্রহ করে ফর্মটি আবার জমা দিন।
                    </div>
                </div>
            </section>

            <!-- About Us Page -->
            <section id="about" class="page hidden">
                <div class="max-w-4xl mx-auto themed-bg-primary p-6 md:p-8 rounded-2xl shadow-md">
                    <h2 class="text-3xl font-bold themed-accent-text mb-2 text-center" data-lang-key="about_title">আমাদের সম্পর্কে</h2>
                     <p id="about_subtitle" class="text-center text-xl font-semibold themed-text-secondary mb-6" data-lang-key="about_subtitle">দারুল ইফতা হাসানিয়া</p>
                    <div class="text-center mb-6">
                        <i class="fas fa-mosque text-6xl themed-accent-text"></i>
                    </div>
                    <p id="about_text" class="themed-text-secondary text-lg leading-relaxed text-center" data-lang-key="about_text">
                        হাসানিয়া দারুল ইফতা একটি অলাভজনক ইসলামী গবেষণা কেন্দ্র। আমাদের লক্ষ্য হলো কুরআন ও সুন্নাহর আলোকে সঠিক ইসলামী জ্ঞান মানুষের কাছে পৌঁছে দেওয়া। আমরা দৈনন্দিন জীবনের বিভিন্ন বিষয়ে শরঈ সমাধান প্রদান করে থাকি। আমাদের অভিজ্ঞ মুফতিগণ সর্বদা আপনাদের প্রশ্নের উত্তর দেওয়ার জন্য প্রস্তুত।
                    </p>
                    <div class="mt-8 border-t themed-border pt-6 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                        <div>
                            <i class="fas fa-bullseye text-4xl themed-accent-text mb-2"></i>
                            <h3 class="text-xl font-bold" data-lang-key="about_mission_title">আমাদের লক্ষ্য</h3>
                            <p class="themed-text-secondary" data-lang-key="about_mission_text">সঠিক দ্বীনি জ্ঞান প্রচার করা।</p>
                        </div>
                         <div>
                            <i class="fas fa-book-reader text-4xl themed-accent-text mb-2"></i>
                            <h3 class="text-xl font-bold" data-lang-key="about_service_title">আমাদের সেবা</h3>
                            <p class="themed-text-secondary" data-lang-key="about_service_text">জরুরী মাসায়েল এবং ফতোয়া প্রদান।</p>
                        </div>
                         <div>
                            <i class="fas fa-users text-4xl themed-accent-text mb-2"></i>
                            <h3 class="text-xl font-bold" data-lang-key="about_team_title">আমাদের টিম</h3>
                            <p class="themed-text-secondary" data-lang-key="about_team_text">একদল বিজ্ঞ ও অভিজ্ঞ আলেম।</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Contact Page -->
            <section id="contact" class="page hidden">
                 <div class="max-w-2xl mx-auto themed-bg-primary p-6 md:p-8 rounded-2xl shadow-md">
                    <h2 class="text-3xl font-bold themed-accent-text mb-6 text-center" data-lang-key="contact_title">যোগাযোগ</h2>
                    <ul class="space-y-4 text-lg">
                        <li class="flex items-start">
                           <i class="fas fa-map-marker-alt themed-accent-text mt-1 ltr:mr-4 rtl:ml-4"></i>
                           <span id="contact_address" class="themed-text-secondary" data-lang-key="contact_address">হাসানিয়া দারুল ইফতা, রঘুনাথপুর, শিঙ্গাশোলপুর, কালিয়া, নড়াইল।</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone-alt themed-accent-text ltr:mr-4 rtl:ml-4"></i>
                            <a href="tel:01895286282" class="themed-text-secondary hover:themed-accent-text">০১৮৯৫২৮৬২৮২</a>
                        </li>
                        <li class="flex items-center">
                           <i class="fas fa-envelope themed-accent-text ltr:mr-4 rtl:ml-4"></i>
                            <a href="mailto:najmulislamn1990@gmail.com" class="themed-text-secondary hover:themed-accent-text">najmulislamn1990@gmail.com</a>
                        </li>
                    </ul>
                 </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="themed-bg-primary mt-8 py-6 px-4 text-center border-t themed-border">
            <p id="footer_text" class="themed-text-secondary mb-4 font-semibold" data-lang-key="footer_text">পৃথিবীর যেকোন প্রান্ত থেকে আপনার জরুরী মাসয়ালা জানার জন্য এখনই যোগাযোগ করুন।</p>
            <div class="flex justify-center space-x-6">
                <a href="#" class="themed-text-secondary hover:themed-accent-text transition duration-300 text-2xl"><i class="fab fa-youtube"></i></a>
                <a href="#" class="themed-text-secondary hover:themed-accent-text transition duration-300 text-2xl"><i class="fab fa-facebook"></i></a>
                <a href="#" class="themed-text-secondary hover:themed-accent-text transition duration-300 text-2xl"><i class="fab fa-whatsapp"></i></a>
            </div>
             <p id="footer_copyright" class="mt-4 text-sm themed-text-secondary" data-lang-key="footer_copyright">&copy; ২০২৩-২০২৪ দারুল ইফতা হাসানিয়া। সর্বস্বত্ব সংরক্ষিত।</p>
        </footer>

    </div>

    <!-- Masayel Read More Modal -->
    <div id="masayel-modal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4 hidden opacity-0">
        <div id="modal-content" class="themed-bg-primary rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6 relative">
            <button id="modal-close-button" class="absolute top-4 ltr:right-4 rtl:left-4 text-2xl themed-text-secondary hover:themed-text-primary">&times;</button>
            <h2 id="modal-title" class="text-2xl md:text-3xl font-bold themed-accent-text mb-4"></h2>
            <p id="modal-body" class="themed-text-secondary leading-relaxed whitespace-pre-wrap"></p>
            <div class="mt-6 border-t themed-border pt-4 flex items-center justify-end space-x-3">
                 <button id="bookmark-button" title="বুকমার্ক করুন" data-lang-key-title="modal_bookmark" class="p-2 rounded-full hover:themed-bg-accent">
                    <i class="far fa-bookmark text-xl themed-text-primary"></i>
                </button>
                <button id="copy-button" title="কপি করুন" data-lang-key-title="modal_copy" class="p-2 rounded-full hover:themed-bg-accent">
                    <i class="fas fa-copy text-xl themed-text-primary"></i>
                </button>
                <button id="share-button" title="শেয়ার করুন" data-lang-key-title="modal_share" class="p-2 rounded-full hover:themed-bg-accent">
                    <i class="fas fa-share-alt text-xl themed-text-primary"></i>
                </button>
            </div>
            <div id="copy-success-toast" class="hidden absolute bottom-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded-md" data-lang-key="toast_copied">কপি করা হয়েছে!</div>
        </div>
    </div>


<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- LANGUAGE DATA ---
    const languageData = {
        bn: {
            nav_home: 'হোম',
            nav_masayel: 'মাসায়েল',
            nav_ask: 'প্রশ্ন করুন',
            nav_about: 'আমাদের সম্পর্কে',
            nav_contact: 'যোগাযোগ',
            cat_taharat: 'ত্বহারাত',
            cat_salat: 'সালাত',
            cat_sawm: 'রোজা',
            cat_zakat: 'যাকাত',
            cat_hajj: 'হজ্ব',
            cat_muamalat: 'মুআমালাত',
            cat_marriage: 'বিবাহ ও তালাক',
            cat_halal: 'জায়েজ-নাজায়েজ',
            header_title: 'দারুল ইফতা হাসানিয়া',
            drawer_title: 'দারুল ইফতা',
            drawer_subtitle: 'হাসানিয়া, নড়াইল',
            marquee_text: '★ জরুরী মাসয়ালা জানার জন্য এখনই আপনার প্রশ্ন করুন ★',
            welcome_title: 'আসসালামু আলাইকুম ওয়া রাহমাতুল্লাহ',
            welcome_text: 'হাসানিয়া দারুল ইফতার ওয়েবসাইটে আপনাকে স্বাগতম। এখানে আপনি কুরআন ও সুন্নাহর আলোকে আপনার প্রয়োজনীয় মাসায়েল জানতে পারবেন।',
            quran_verse_title: 'কুরআনের বাণী',
            hadith_verse_title: 'হাদিসের বাণী',
            prayer_times_title: 'নামাজের সময়সূচী',
            location_label: 'লোকেশন:',
            prayer_name: 'নামাজ',
            prayer_time: 'সময়',
            urgent_masayel: 'জরুরী মাসায়েল',
            ask_form_title: 'প্রশ্ন করুন',
            form_name: 'নাম',
            form_anonymous: 'নাম প্রকাশে অনিচ্ছুক',
            form_email: 'ইমেইল অ্যাড্রেস',
            form_phone: 'ফোন নম্বর (ঐচ্ছিক)',
            form_subject: 'প্রশ্নের বিষয়',
            form_details: 'প্রশ্নের বিস্তারিত',
            form_submit: 'জমা দিন',
            form_success: 'আপনার প্রশ্ন সফলভাবে জমা দেওয়া হয়েছে। আমরা শীঘ্রই আপনার সাথে যোগাযোগ করব।',
            form_error: 'কিছু একটা সমস্যা হয়েছে। অনুগ্রহ করে ফর্মটি আবার জমা দিন।',
            about_title: 'আমাদের সম্পর্কে',
            about_subtitle: 'দারুল ইফতা হাসানিয়া',
            about_text: 'হাসানিয়া দারুল ইফতা একটি অলাভজনক ইসলামী গবেষণা কেন্দ্র। আমাদের লক্ষ্য হলো কুরআন ও সুন্নাহর আলোকে সঠিক ইসলামী জ্ঞান মানুষের কাছে পৌঁছে দেওয়া। আমরা দৈনন্দিন জীবনের বিভিন্ন বিষয়ে শরঈ সমাধান প্রদান করে থাকি। আমাদের অভিজ্ঞ মুফতিগণ সর্বদা আপনাদের প্রশ্নের উত্তর দেওয়ার জন্য প্রস্তুত।',
            about_mission_title: 'আমাদের লক্ষ্য',
            about_mission_text: 'সঠিক দ্বীনি জ্ঞান প্রচার করা।',
            about_service_title: 'আমাদের সেবা',
            about_service_text: 'জরুরী মাসায়েল এবং ফতোয়া প্রদান।',
            about_team_title: 'আমাদের টিম',
            about_team_text: 'একদল বিজ্ঞ ও অভিজ্ঞ আলেম।',
            contact_title: 'যোগাযোগ',
            contact_address: 'হাসানিয়া দারুল ইফতা, রঘুনাথপুর, শিঙ্গাশোলপুর, কালিয়া, নড়াইল।',
            footer_text: 'পৃথিবীর যেকোন প্রান্ত থেকে আপনার জরুরী মাসয়ালা জানার জন্য এখনই যোগাযোগ করুন।',
            footer_copyright: '© ২০২৩-২০২৪ দারুল ইফতা হাসানিয়া। সর্বস্বত্ব সংরক্ষিত।',
            modal_read_more: 'আরো পড়ুন',
            modal_bookmark: 'বুকমার্ক করুন',
            modal_copy: 'কপি করুন',
            modal_share: 'শেয়ার করুন',
            toast_copied: 'কপি করা হয়েছে!',
            prayer_fajr: 'ফজর',
            prayer_dhuhr: 'যোহর',
            prayer_asr: 'আসর',
            prayer_maghrib: 'মাগরিব',
            prayer_isha: 'ইশা',
            prayer_tahajjud: 'তাহাজ্জুদ',
            forbidden_times_title: 'নামাজের নিষিদ্ধ সময়',
            forbidden_sunrise: 'সূর্যোদয়',
            forbidden_midday: 'দ্বিপ্রহর (যাওয়াল)',
            forbidden_sunset: 'সূর্যাস্ত',
        },
        en: {
            nav_home: 'Home',
            nav_masayel: 'Masayel',
            nav_ask: 'Ask Question',
            nav_about: 'About Us',
            nav_contact: 'Contact',
            cat_taharat: 'Purity',
            cat_salat: 'Salat',
            cat_sawm: 'Fasting',
            cat_zakat: 'Zakat',
            cat_hajj: 'Hajj',
            cat_muamalat: 'Transactions',
            cat_marriage: 'Marriage & Divorce',
            cat_halal: 'Halal & Haram',
            header_title: 'Darul Ifta Hasania',
            drawer_title: 'Darul Ifta',
            drawer_subtitle: 'Hasania, Narail',
            marquee_text: '★ Ask your urgent questions now ★',
            welcome_title: 'Assalamu Alaikum wa Rahmatullah',
            welcome_text: 'Welcome to the Hasania Darul Ifta website. Here you can find solutions to your questions in the light of the Quran and Sunnah.',
            quran_verse_title: 'Verse from Quran',
            hadith_verse_title: 'Verse from Hadith',
            prayer_times_title: 'Prayer Times',
            location_label: 'Location:',
            prayer_name: 'Prayer',
            prayer_time: 'Time',
            urgent_masayel: 'Urgent Masayel',
            ask_form_title: 'Ask a Question',
            form_name: 'Name',
            form_anonymous: 'Wish to be anonymous',
            form_email: 'Email Address',
            form_phone: 'Phone Number (Optional)',
            form_subject: 'Subject of Question',
            form_details: 'Details of Question',
            form_submit: 'Submit',
            form_success: 'Your question has been submitted successfully. We will contact you soon.',
            form_error: 'Something went wrong. Please submit the form again.',
            about_title: 'About Us',
            about_subtitle: 'Darul Ifta Hasania',
            about_text: 'Hasania Darul Ifta is a non-profit Islamic research center. Our goal is to spread authentic Islamic knowledge in the light of the Quran and Sunnah. We provide Shariah solutions for various aspects of daily life. Our experienced Muftis are always ready to answer your questions.',
            about_mission_title: 'Our Mission',
            about_mission_text: 'To spread authentic religious knowledge.',
            about_service_title: 'Our Services',
            about_service_text: 'Providing urgent masayel and fatwas.',
            about_team_title: 'Our Team',
            about_team_text: 'A group of knowledgeable and experienced scholars.',
            contact_title: 'Contact',
            contact_address: 'Hasania Darul Ifta, Raghunathpur, Shingasholpur, Kalia, Narail.',
            footer_text: 'Contact us from anywhere in the world to know your urgent masayel.',
            footer_copyright: '© 2023-2024 Darul Ifta Hasania. All rights reserved.',
            modal_read_more: 'Read More',
            modal_bookmark: 'Bookmark',
            modal_copy: 'Copy',
            modal_share: 'Share',
            toast_copied: 'Copied!',
            prayer_fajr: 'Fajr',
            prayer_dhuhr: 'Dhuhr',
            prayer_asr: 'Asr',
            prayer_maghrib: 'Maghrib',
            prayer_isha: 'Isha',
            prayer_tahajjud: 'Tahajjud',
            forbidden_times_title: 'Forbidden Times for Prayer',
            forbidden_sunrise: 'Sunrise',
            forbidden_midday: 'Midday (Zawal)',
            forbidden_sunset: 'Sunset',
        },
        ur: {
            nav_home: 'گھر',
            nav_masayel: 'مسائل',
            nav_ask: 'سوال پوچھیں',
            nav_about: 'ہمارے بارے میں',
            nav_contact: 'رابطہ',
            cat_taharat: 'طہارت',
            cat_salat: 'صلوٰۃ',
            cat_sawm: 'روزہ',
            cat_zakat: 'زکوٰۃ',
            cat_hajj: 'حج',
            cat_muamalat: 'معاملات',
            cat_marriage: 'شادی اور طلاق',
            cat_halal: 'جائز و ناجائز',
            header_title: 'دارالافتاء حسنیہ',
            drawer_title: 'دارالافتاء',
            drawer_subtitle: 'حسنیہ، نڑাইল',
            marquee_text: '★ فوری مسائل جاننے کے لیے ابھی اپنا سوال پوچھیں ★',
            welcome_title: 'السلام علیکم ورحمتہ اللہ',
            welcome_text: 'دارالافتاء حسنیہ کی ویب سائٹ پر خوش آمدید۔ یہاں آپ قرآن و سنت کی روشنی میں اپنے ضروری مسائل جان سکتے ہیں۔',
            quran_verse_title: 'قرآن کا پیغام',
            hadith_verse_title: 'حدیث کا پیغام',
            prayer_times_title: 'نماز کے اوقات',
            location_label: 'مقام:',
            prayer_name: 'نماز',
            prayer_time: 'وقت',
            urgent_masayel: 'فوری مسائل',
            ask_form_title: 'سوال پوچھیں',
            form_name: 'نام',
            form_anonymous: 'نام ظاہر نہ کرنا',
            form_email: 'ای میل اڈریس',
            form_phone: 'فون نمبر (اختیاری)',
            form_subject: 'سوال کا موضوع',
            form_details: 'سوال کی تفصیل',
            form_submit: 'جمع کرائیں',
            form_success: 'آپ کا سوال کامیابی سے جمع ہو گیا ہے۔ ہم جلد ہی آپ سے رابطہ کریں گے۔',
            form_error: 'کچھ غلط ہو گیا ہے۔ براہ کرم فارم دوبارہ جمع کرائیں۔',
            about_title: 'ہمارے بارے میں',
            about_subtitle: 'دارالافتاء حسنیہ',
            about_text: 'دارالافتاء حسنیہ ایک غیر منافع بخش اسلامی تحقیقی مرکز ہے۔ ہمارا مقصد قرآن و سنت کی روشنی میں صحیح اسلامی علم کو لوگوں تک پہنچانا ہے۔ ہم روزمرہ زندگی کے مختلف مسائل پر شرعی حل فراہم کرتے ہیں۔ ہمارے تجربہ کار مفتیان کرام ہمیشہ آپ کے سوالات کے جوابات دینے کے لیے تیار ہیں۔',
            about_mission_title: 'ہمارا مقصد',
            about_mission_text: 'صحیح دینی علم کو پھیلانا۔',
            about_service_title: 'ہماری خدمات',
            about_service_text: 'فوری مسائل اور فتاویٰ فراہم کرنا۔',
            about_team_title: 'ہماری ٹیم',
            about_team_text: 'علمائے کرام کی ایک ٹیم۔',
            contact_title: 'رابطہ',
            contact_address: 'دارالافتاء حسنیہ، رگھوناتھ پور، شنگاشول پور، کالیا، نڑাইল۔',
            footer_text: 'دنیا کے کسی بھی کونے سے اپنے فوری مسائل جاننے کے لیے ابھی رابطہ کریں۔',
            footer_copyright: '© 2023-2024 دارالافتاء حسنیہ۔ جملہ حقوق محفوظ ہیں۔',
            modal_read_more: 'مزید پڑھیں',
            modal_bookmark: 'بک مارک',
            modal_copy: 'کاپی',
            modal_share: 'شیئر',
            toast_copied: 'کاپی ہو گیا!',
            prayer_fajr: 'فجر',
            prayer_dhuhr: 'ظہر',
            prayer_asr: 'عصر',
            prayer_maghrib: 'مغرب',
            prayer_isha: 'عشاء',
            prayer_tahajjud: 'تہجد',
            forbidden_times_title: 'نماز کے ممنوعہ اوقات',
            forbidden_sunrise: 'طلوع آفتاب',
            forbidden_midday: 'زوال',
            forbidden_sunset: 'غروب آفتاب',
        },
        ar: {
            nav_home: 'الرئيسية',
            nav_masayel: 'المسائل',
            nav_ask: 'اسأل سؤالاً',
            nav_about: 'معلومات عنا',
            nav_contact: 'اتصل بنا',
            cat_taharat: 'الطهارة',
            cat_salat: 'الصلاة',
            cat_sawm: 'الصوم',
            cat_zakat: 'الزكاة',
            cat_hajj: 'الحج',
            cat_muamalat: 'المعاملات',
            cat_marriage: 'الزواج والطلاق',
            cat_halal: 'الحلال والحرام',
            header_title: 'دار الإفتاء الحسنية',
            drawer_title: 'دار الإفتاء',
            drawer_subtitle: 'الحسنية، نارائل',
            marquee_text: '★ لطرح أسئلتكم العاجلة، اسألوا الآن ★',
            welcome_title: 'السلام عليكم ورحمة الله',
            welcome_text: 'مرحبا بكم في موقع دار الإفتاء الحسنية. هنا تجدون حلولاً لمسائلكم في ضوء القرآن والسنة.',
            quran_verse_title: 'آية من القرآن',
            hadith_verse_title: 'حديث شريف',
            prayer_times_title: 'أوقات الصلاة',
            location_label: 'الموقع:',
            prayer_name: 'الصلاة',
            prayer_time: 'الوقت',
            urgent_masayel: 'مسائل عاجلة',
            ask_form_title: 'اسأل سؤالاً',
            form_name: 'الاسم',
            form_anonymous: 'إخفاء الاسم',
            form_email: 'البريد الإلكتروني',
            form_phone: 'رقم الهاتف (اختياري)',
            form_subject: 'موضوع السؤال',
            form_details: 'تفاصيل السؤال',
            form_submit: 'إرسال',
            form_success: 'تم إرسال سؤالك بنجاح. سنتصل بك قريبا.',
            form_error: 'حدث خطأ ما. يرجى إرسال النموذج مرة أخرى.',
            about_title: 'معلومات عنا',
            about_subtitle: 'دار الإفتاء الحسنية',
            about_text: 'دار الإفتاء الحسنية هو مركز أبحاث إسلامي غير ربحي. هدفنا هو نشر المعرفة الإسلامية الصحيحة في ضوء القرآن والسنة. نقدم حلولاً شرعية لمختلف جوانب الحياة اليومية. مفتيونا ذوو الخبرة على استعداد دائم للإجابة على أسئلتكم.',
            about_mission_title: 'مهمتنا',
            about_mission_text: 'نشر المعرفة الدينية الصحيحة.',
            about_service_title: 'خدماتنا',
            about_service_text: 'تقديم المسائل والفتاوى العاجلة.',
            about_team_title: 'فريقنا',
            about_team_text: 'مجموعة من العلماء ذوي المعرفة والخبرة.',
            contact_title: 'اتصل بنا',
            contact_address: 'دار الإفتاء الحسنية، راغوناثبور، شينغاشولبور، كاليا، نارائل.',
            footer_text: 'اتصل بنا من أي مكان في العالم لمعرفة مسائلكم العاجلة.',
            footer_copyright: '© 2023-2024 دار الإفتاء الحسنية. جميع الحقوق محفوظة.',
            modal_read_more: 'اقرأ المزيد',
            modal_bookmark: 'إشارة مرجعية',
            modal_copy: 'نسخ',
            modal_share: 'مشاركة',
            toast_copied: 'تم النسخ!',
            prayer_fajr: 'الفجر',
            prayer_dhuhr: 'الظهر',
            prayer_asr: 'العصر',
            prayer_maghrib: 'المغرب',
            prayer_isha: 'العشاء',
            prayer_tahajjud: 'التهجد',
            forbidden_times_title: 'الأوقات المنهي عن الصلاة فيها',
            forbidden_sunrise: 'شروق الشمس',
            forbidden_midday: 'وقت الزوال',
            forbidden_sunset: 'غروب الشمس',
        }
    };

    // --- DATA ---
    const imageSliderData = [
        'https://placehold.co/800x400/00897B/FFFFFF?text=Darul+Ifta+Hasania',
        'https://placehold.co/800x400/4DB6AC/FFFFFF?text=Islamic+Knowledge',
        'https://placehold.co/800x400/004D40/FFFFFF?text=Quran+%26+Sunnah',
    ];

    const quranVerses = {
        bn: '"আর তোমরা নামাজ প্রতিষ্ঠা কর, যাকাত প্রদান কর এবং রুকুকারীদের সাথে রুকু কর।" (সূরা আল-বাকারা, আয়াত ৪৩)',
        en: '"And establish prayer and give zakah and bow with those who bow [in worship and obedience]." (Surah Al-Baqarah, Ayah 43)',
        ur: '"اور نماز قائم کرو اور زکوٰۃ دو اور رکوع کرنے والوں کے ساتھ رکوع کرو۔" (سورۃ البقرۃ، آیت 43)',
        ar: '"وَأَقِيمُوا الصَّلَاةَ وَآتُوا الزَّكَاةَ وَارْكَعُوا مَعَ الرَّاكِعِينَ" (سورة البقرة، آية 43)'
    };

    const hadithVerses = {
        bn: 'রাসূলুল্লাহ (ﷺ) বলেছেন, "জ্ঞান অর্জন করা প্রত্যেক মুসলিমের উপর ফরজ।" (ইবনে মাজাহ)',
        en: 'The Messenger of Allah (ﷺ) said, "Seeking knowledge is an obligation upon every Muslim." (Ibn Majah)',
        ur: 'رسول اللہ (ﷺ) نے فرمایا، "علم حاصل کرنا ہر مسلمان پر فرض ہے۔" (ابن ماجہ)',
        ar: 'قال رسول الله صلى الله عليه وسلم: "طلب العلم فريضة على كل مسلم". (ابن ماجه)'
    };
    
    const locations = [
        "Bagerhat", "Bandarban", "Barguna", "Barishal", "Bhola", "Bogra", "Brahmanbaria", "Chandpur", 
        "Chapainawabganj", "Chattogram", "Chuadanga", "Comilla", "Cox's Bazar", "Dhaka", "Dinajpur", 
        "Faridpur", "Feni", "Gaibandha", "Gazipur", "Gopalganj", "Habiganj", "Jamalpur", "Jashore", 
        "Jhalokati", "Jhenaidah", "Joypurhat", "Khagrachhari", "Khulna", "Kishoreganj", "Kurigram", 
        "Kushtia", "Lakshmipur", "Lalmonirhat", "Madaripur", "Magura", "Manikganj", "Meherpur", 
        "Moulvibazar", "Munshiganj", "Mymensingh", "Naogaon", "Narail", "Narayanjong", "Narsingdi", 
        "Natore", "Netrokona", "Nilphamari", "Noakhali", "Pabna", "Panchagarh", "Patuakhali", 
        "Pirojpur", "Rajbari", "Rajshahi", "Rangamati", "Rangpur", "Satkhira", "Shariatpur", 
        "Sherpur", "Sirajganj", "Sunamganj", "Sylhet", "Tangail", "Thakurgaon"
    ];

    const masayelData = [
        { id: 1, category: 'ত্বহারাত', title: {bn: 'ওযুর ফরজ কয়টি?', en: 'How many Fardh in Wudu?', ur: 'وضو کے فرائض کتنے ہیں؟', ar: 'ما هي فرائض الوضوء؟'}, summary: {bn: 'ওযুর ফরজ চারটি। যথা: (১) মুখমন্ডল ধোয়া...', en: 'There are four Fardh acts in Wudu: (1) Washing the face...', ur: 'وضو کے چار فرائض ہیں: (۱) چہرہ دھونا...', ar: 'فرائض الوضوء أربعة: (١) غسل الوجه...'}, content: {bn: 'ওযুর ফরজ চারটি। যথা: (১) মুখমন্ডল ধোয়া। (২) কনুইসহ উভয় হাত ধোয়া। (৩) মাথার এক-চতুর্থাংশ মাসেহ করা। (৪) টাখনুসহ উভয় পা ধোয়া।', en: 'There are four Fardh acts in Wudu: (1) Washing the entire face. (2) Washing both arms up to and including the elbows. (3) Wiping a quarter of the head. (4) Washing both feet up to and including the ankles.', ur: 'وضو کے چار فرائض ہیں: (۱) پورا چہرہ دھونا۔ (۲) دونوں ہاتھ کہنیوں سمیت دھونا۔ (۳) سر کا چوتھائی حصہ مسح کرنا۔ (۴) دونوں پاؤں ٹخنوں سمیت دھونا۔', ar: 'فرائض الوضوء أربعة: (١) غسل الوجه كاملاً. (٢) غسل اليدين مع المرفقين. (٣) مسح ربع الرأس. (٤) غسل الرجلين مع الكعبين.'} },
        { id: 2, category: 'ত্বহারাত', title: {bn: 'গোসলের ফরজ কয়টি?', en: 'How many Fardh in Ghusl?', ur: 'غسل کے فرائض کتنے ہیں؟', ar: 'ما هي فرائض الغسل؟'}, summary: {bn: 'গোসলের ফরজ তিনটি। যথা: (১) ভালোভাবে কুলি করা...', en: 'There are three Fardh acts in Ghusl: (1) Rinsing the mouth thoroughly...', ur: 'غسل کے تین فرائض ہیں: (۱) اچھی طرح کلی کرنا...', ar: 'فرائض الغسل ثلاثة: (١) المضمضة جيداً...'}, content: {bn: 'গোসলের ফরজ তিনটি। যথা: (১) ভালোভাবে কুলি করা। (২) নাকে পানি দেওয়া। (৩) সর্ব শরীর ধোয়া।', en: 'There are three Fardh acts in Ghusl: (1) Rinsing the mouth thoroughly. (2) Sniffing water into the nose. (3) Washing the entire body.', ur: 'غسل کے تین فرائض ہیں: (۱) اچھی طرح کلی کرنا۔ (۲) ناک میں پانی ڈالنا۔ (۳) پورے جسم کو دھونا۔', ar: 'فرائض الغسل ثلاثة: (١) المضمضة جيداً. (٢) الاستنشاق. (٣) غسل سائر الجسد.'} },
        { id: 3, category: 'সালাত', title: {bn: 'সালাতের আরকান ও আহকাম', en: 'Pillars & Conditions of Salat', ur: 'نماز کے ارکان و احکام', ar: 'أركان وشروط الصلاة'}, summary: {bn: 'সালাতের ভেতরে ও বাইরে কিছু ফরজ কাজ আছে...', en: 'There are some obligatory acts inside and outside of Salat...', ur: 'نماز کے اندر اور باہر کچھ فرض کام ہیں...', ar: 'هناك أعمال واجبة داخل الصلاة وخارجها...'}, content: {bn: 'সালাতের বাইরে ৭টি এবং ভেতরে ৬টি ফরজ রয়েছে। এগুলোকে একত্রে সালাতের আরকান ও আহকাম বলা হয়। এর কোনো একটি ছুটে গেলে সালাত আদায় হয় না।', en: 'There are 7 obligatory acts outside of Salat and 6 inside. Together, they are called the pillars and conditions of Salat. If any of these are missed, the prayer is not valid.', ur: 'نماز کے باہر 7 اور اندر 6 فرائض ہیں۔ انہیں مجموعی طور پر نماز کے ارکان و احکام کہا جاتا ہے۔ ان میں سے کسی ایک کے چھوٹ جانے سے نماز ادا نہیں ہوتی۔', ar: 'هناك 7 شروط خارج الصلاة و 6 أركان داخلها. تسمى مجتمعة أركان وشروط الصلاة. إذا فات أحدها، فالصلاة غير صحيحة.'} },
    ];
    
    // --- DOM SELECTORS ---
    const drawer = document.getElementById('drawer');
    const menuButton = document.getElementById('menu-button');
    const drawerOverlay = document.getElementById('drawer-overlay');
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const navLinks = document.querySelectorAll('.nav-link');
    const pages = document.querySelectorAll('.page');
    const masayelMenuContainer = document.getElementById('masayel-menu-container');
    const masayelSubmenu = document.getElementById('masayel-submenu');
    const locationSelector = document.getElementById('location-selector');

    // --- STATE ---
    let currentSlide = 0;
    let isDrawerOpen = false;
    let currentLang = 'bn';

    // --- INITIALIZATION ---
    function init() {
        setupLanguageSwitcher(); 
        setupNavigation();
        setupDarkMode();
        setupMasayelMenu();
        setupPrayerTimes();
        initSlider();
        renderHomeCategories();
        renderMasayel('all');
        setupAskForm();
        setupModal();
        
        // Initial language application
        const savedLang = localStorage.getItem('language') || 'bn';
        changeLanguage(savedLang, true);
    }

    // --- NAVIGATION ---
    function setupNavigation() {
        menuButton.addEventListener('click', toggleDrawer);
        drawerOverlay.addEventListener('click', toggleDrawer);

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                const targetId = e.currentTarget.getAttribute('href').substring(1);
                
                const category = e.currentTarget.dataset.category;
                if (category) {
                    renderMasayel(category);
                    updateMasayelPageTitle(e.currentTarget.textContent);
                } else if (targetId === 'masayel') {
                    renderMasayel('all');
                    updateMasayelPageTitle();
                }

                showPage(targetId);
                updateActiveLink(e.currentTarget);
                if (isDrawerOpen) {
                    toggleDrawer();
                }
            });
        });
        
        const initialHash = window.location.hash || '#home';
        showPage(initialHash.substring(1));
        updateActiveLink(document.querySelector(`.nav-link[href="${initialHash}"]`));
    }

    function showPage(pageId) {
        pages.forEach(page => {
            page.style.display = page.id === pageId ? 'block' : 'none';
        });
        window.scrollTo(0, 0);
    }
    
    function updateActiveLink(activeLink) {
        navLinks.forEach(link => link.classList.remove('active'));
        if (activeLink) {
            activeLink.classList.add('active');
        }
    }

    function toggleDrawer() {
        isDrawerOpen = !isDrawerOpen;
        drawer.classList.toggle('open');
        drawerOverlay.classList.toggle('hidden');
    }
    
    function setupMasayelMenu() {
        const masayelLink = masayelMenuContainer.querySelector('a');
        masayelLink.addEventListener('click', (e) => {
            if (e.target.closest('a').dataset.category) return;
            e.preventDefault();
            masayelSubmenu.classList.toggle('hidden');
            masayelLink.querySelector('i').classList.toggle('rotate-180');
        });
    }

    // --- FEATURES ---
    function setupDarkMode() {
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme === 'dark' || (!storedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            darkModeToggle.innerHTML = '<i class="fas fa-sun text-xl themed-text-primary"></i>';
        }

        darkModeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            if (document.documentElement.classList.contains('dark')) {
                localStorage.setItem('theme', 'dark');
                darkModeToggle.innerHTML = '<i class="fas fa-sun text-xl themed-text-primary"></i>';
            } else {
                localStorage.setItem('theme', 'light');
                darkModeToggle.innerHTML = '<i class="fas fa-moon text-xl themed-text-primary"></i>';
            }
        });
    }

    function updateAllUIText(lang) {
        document.querySelectorAll('[data-lang-key]').forEach(el => {
            const key = el.dataset.langKey;
            if (languageData[lang][key]) {
                el.textContent = languageData[lang][key];
            }
        });
        
        document.querySelectorAll('[data-lang-key-title]').forEach(el => {
            const key = el.dataset.langKeyTitle;
            if (languageData[lang][key]) {
                el.title = languageData[lang][key];
            }
        });
        
        document.getElementById('quran-verse').textContent = quranVerses[lang];
        document.getElementById('hadith-verse').textContent = hadithVerses[lang];

        updateHomeCategoriesText(lang);
        updateMasayelCardsText(lang);
        updateMasayelPageTitle();
        updatePrayerTimesText(lang);
    }
    
    function changeLanguage(lang, isInitial = false) {
        currentLang = lang;
        document.documentElement.lang = lang;
        document.documentElement.dir = (lang === 'ur' || lang === 'ar') ? 'rtl' : 'ltr';

        updateAllUIText(lang);
        
        if (!isInitial) {
            fetchPrayerTimes(locationSelector.value);
        }
        
        localStorage.setItem('language', lang);
    }
    
    function setupLanguageSwitcher() {
        const langMenu = document.getElementById('lang-menu');
        document.getElementById('lang-button').addEventListener('click', (e) => {
            e.stopPropagation();
            langMenu.classList.toggle('hidden');
        });

        document.querySelectorAll('[data-lang]').forEach(el => {
            el.addEventListener('click', (e) => {
                e.preventDefault();
                changeLanguage(e.target.dataset.lang);
                langMenu.classList.add('hidden');
            });
        });
        
        document.addEventListener('click', (e) => {
            if (!langMenu.contains(e.target) && !langMenu.classList.contains('hidden')) {
                langMenu.classList.add('hidden');
            }
        });
    }

    // --- PRAYER TIMES LOGIC ---
    function setupPrayerTimes() {
        locations.forEach(district => {
            const option = document.createElement('option');
            option.value = district;
            option.textContent = district;
            if (district === "Khulna") {
                option.selected = true;
            }
            locationSelector.appendChild(option);
        });

        locationSelector.addEventListener('change', (e) => {
            fetchPrayerTimes(e.target.value);
        });
        
        fetchPrayerTimes(locationSelector.value);
    }

    async function fetchPrayerTimes(city) {
        const tableBody = document.getElementById('prayer-times-body');
        const originalHtml = tableBody.innerHTML;
        tableBody.innerHTML = `
            <tr>
                <td colspan="2" class="py-10 text-center themed-text-secondary">
                    <i class="fas fa-spinner fa-spin text-2xl"></i>
                </td>
            </tr>
        `;

        try {
            const response = await fetch(`https://api.aladhan.com/v1/timingsByCity?country=BD&city=${city}`);
            if (!response.ok) throw new Error('Network error');
            const data = await response.json();
            displayPrayerTimes(data.data.timings);
        } catch (error) {
            console.error('Failed to fetch prayer times:', error);
            tableBody.innerHTML = originalHtml; // Restore previous content on error
        }
    }

    function updatePrayerTimesText(lang, times) {
        const prayerOrderMap = {
            prayer_fajr: 'Fajr',
            prayer_dhuhr: 'Dhuhr',
            prayer_asr: 'Asr',
            prayer_maghrib: 'Maghrib',
            prayer_isha: 'Isha'
        };

        const rows = document.getElementById('prayer-times-body').querySelectorAll('tr');
        rows.forEach(row => {
            const key = row.dataset.prayerKey;
            if (key) {
                row.querySelector('td:first-child').textContent = languageData[lang][key];
                if(times && prayerOrderMap[key]) {
                    row.querySelector('td:last-child').textContent = times[prayerOrderMap[key]];
                }
            }
        });

        const forbiddenTimesDiv = document.getElementById('forbidden-times');
        if (times) {
            let sunriseText, middayText, sunsetText;
             if(currentLang === 'bn') {
                sunriseText = `সূর্যোদয়ের মুহূর্ত (${times.Sunrise}) থেকে প্রায় ১৫-২০ মিনিট পর্যন্ত।`;
                middayText = `যোহরের সময় শুরু হওয়ার প্রায় ১৫ মিনিট আগে থেকে সূর্য ঢলে পড়া পর্যন্ত।`;
                sunsetText = `সূর্যাস্তের (${times.Sunset}) আগের ১৫-২০ মিনিট থেকে শুরু করে সূর্য পুরোপুরি অস্ত যাওয়া পর্যন্ত।`;
            } else if (currentLang === 'en') {
                sunriseText = `From the moment of sunrise (${times.Sunrise}) for about 15-20 minutes.`;
                middayText = `About 15 minutes before Dhuhr time until the sun passes its zenith.`;
                sunsetText = `About 15-20 minutes before sunset (${times.Sunset}) until the sun has completely set.`;
            } else {
                 sunriseText = `من لحظة شروق الشمس (${times.Sunrise}) لمدة 15-20 دقيقة تقريبًا.`;
                 middayText = `قبل وقت الظهر بحوالي 15 دقيقة حتى تزول الشمس.`;
                 sunsetText = `قبل غروب الشمس (${times.Sunset}) بحوالي 15-20 دقيقة حتى تغرب الشمس تمامًا.`;
            }

            forbiddenTimesDiv.innerHTML = `
                <h4 class="font-bold text-lg mb-2">${languageData[lang].forbidden_times_title}</h4>
                <div class="text-left max-w-lg mx-auto themed-text-secondary space-y-2">
                    <p><i class="fas fa-times-circle text-red-500 ltr:mr-2 rtl:ml-2"></i><span class="font-semibold">${languageData[lang].forbidden_sunrise}:</span> ${sunriseText}</p>
                    <p><i class="fas fa-times-circle text-red-500 ltr:mr-2 rtl:ml-2"></i><span class="font-semibold">${languageData[lang].forbidden_midday}:</span> ${middayText}</p>
                    <p><i class="fas fa-times-circle text-red-500 ltr:mr-2 rtl:ml-2"></i><span class="font-semibold">${languageData[lang].forbidden_sunset}:</span> ${sunsetText}</p>
                </div>
            `;
        }
    }


    function displayPrayerTimes(times) {
        const tableBody = document.getElementById('prayer-times-body');
        tableBody.innerHTML = '';
        
        const prayerOrder = [
            { key: 'prayer_fajr', time: times.Fajr },
            { key: 'prayer_dhuhr', time: times.Dhuhr },
            { key: 'prayer_asr', time: times.Asr },
            { key: 'prayer_maghrib', time: times.Maghrib },
            { key: 'prayer_isha', time: times.Isha },
            { key: 'prayer_tahajjud', time: languageData[currentLang].prayer_tahajjud || 'রাতের শেষ তৃতীয়াংশ' }
        ];

        for (const prayer of prayerOrder) {
            const row = document.createElement('tr');
            row.className = 'border-b themed-border last:border-b-0';
            row.dataset.prayerKey = prayer.key;
            row.innerHTML = `
                <td class="py-4 px-2 font-semibold text-lg">${languageData[currentLang][prayer.key]}</td>
                <td class="py-4 px-2 text-lg">${prayer.time}</td>
            `;
            tableBody.appendChild(row);
        }
        updatePrayerTimesText(currentLang, times);
    }

    // --- HOME PAGE LOGIC ---
    function initSlider() {
        const sliderContainer = document.getElementById('image-slider');
        sliderContainer.innerHTML = '';
        imageSliderData.forEach((src, index) => {
            const img = document.createElement('img');
            img.src = src;
            img.alt = `Slide ${index + 1}`;
            img.className = `absolute w-full h-full object-cover transition-opacity duration-1000 ${index === 0 ? 'opacity-100' : 'opacity-0'}`;
            sliderContainer.appendChild(img);
        });

        setInterval(() => {
            const images = sliderContainer.getElementsByTagName('img');
            if (images.length === 0) return;
            images[currentSlide].classList.remove('opacity-100');
            currentSlide = (currentSlide + 1) % images.length;
            images[currentSlide].classList.add('opacity-100');
        }, 5000);
    }
    
    function updateHomeCategoriesText(lang) {
        const container = document.getElementById('home-masayel-categories');
        container.querySelectorAll('a').forEach((catBox, index) => {
            const key = catBox.dataset.langKey;
            catBox.textContent = languageData[lang][key] || catBox.textContent;
        });
    }

    function renderHomeCategories() {
        const container = document.getElementById('home-masayel-categories');
        const categories = [
            { key: 'cat_taharat', bn_val: 'ত্বহারাত' },
            { key: 'cat_salat', bn_val: 'সালাত' },
            { key: 'cat_sawm', bn_val: 'রোজা' },
            { key: 'cat_zakat', bn_val: 'যাকাত' },
            { key: 'cat_hajj', bn_val: 'হজ্ব' },
            { key: 'cat_muamalat', bn_val: 'মুআমালাত' },
            { key: 'cat_marriage', bn_val: 'বিবাহ ও তালাক' },
            { key: 'cat_halal', bn_val: 'জায়েজ-নাজায়েজ' }
        ];
        container.innerHTML = '';
        categories.forEach(cat => {
            const catBox = document.createElement('a');
            catBox.href = '#masayel';
            catBox.className = 'nav-link themed-bg-accent p-4 rounded-xl text-center font-semibold text-white hover:bg-[var(--accent-color-hover)] transition-all duration-300 flex items-center justify-center min-h-[60px]';
            catBox.dataset.langKey = cat.key;
            catBox.dataset.category = cat.bn_val; // Use Bengali for filtering
            container.appendChild(catBox);
        });
        
        container.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const category = e.currentTarget.dataset.category;
                renderMasayel(category);
                updateMasayelPageTitle(e.currentTarget.textContent);
                showPage('masayel');
                updateActiveLink(document.querySelector('#masayel-menu-container a'));
            });
        });
        updateHomeCategoriesText(currentLang);
    }
    
    function updateMasayelPageTitle(subtitle) {
        const titleEl = document.getElementById('masayel-page-title');
        if (subtitle) {
            titleEl.textContent = `${languageData[currentLang].nav_masayel}: ${subtitle}`;
        } else {
            titleEl.textContent = languageData[currentLang].nav_masayel;
        }
    }
    
    function updateMasayelCardsText(lang) {
        const contentDiv = document.getElementById('masayel-content');
        contentDiv.querySelectorAll('.masala-card').forEach(card => {
            const masalaId = card.dataset.id;
            const masala = masayelData.find(m => m.id == masalaId);
            if (masala) {
                card.querySelector('h3').textContent = masala.title[lang];
                card.querySelector('p').textContent = masala.summary[lang];
                card.querySelector('button').textContent = languageData[lang].modal_read_more;
            }
        });
    }

    // --- MASAYEL PAGE LOGIC ---
    function renderMasayel(category) {
        const contentDiv = document.getElementById('masayel-content');
        contentDiv.innerHTML = '';
        const filteredData = category === 'all' ? masayelData : masayelData.filter(m => m.category === category);

        if (filteredData.length === 0) {
            contentDiv.innerHTML = `<p class="themed-text-secondary col-span-full text-center">${languageData[currentLang].no_masayel_found || 'এই বিষয়ে কোনো মাসয়ালা পাওয়া যায়নি।'}</p>`;
            return;
        }

        filteredData.forEach(masala => {
            const card = document.createElement('div');
            card.className = "themed-bg-primary p-6 rounded-2xl shadow-md flex flex-col masala-card";
            card.dataset.id = masala.id;
            card.innerHTML = `
                <h3 class="text-xl font-bold themed-accent-text mb-2">${masala.title[currentLang]}</h3>
                <p class="themed-text-secondary mb-4 flex-grow">${masala.summary[currentLang]}</p>
                <button data-id="${masala.id}" class="read-more-btn mt-auto self-start text-white font-semibold py-2 px-4 rounded-md themed-accent themed-accent-hover transition duration-300">
                    ${languageData[currentLang].modal_read_more}
                </button>
            `;
            contentDiv.appendChild(card);
        });
    }
    
    // --- ASK FORM LOGIC ---
    function setupAskForm() {
        const form = document.getElementById('question-form');
        const successMessage = document.getElementById('form-success-message');
        const errorMessage = document.getElementById('form-error-message');
        const submitButton = form.querySelector('button[type="submit"]');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');

            const originalButtonText = submitButton.textContent;
            submitButton.innerHTML = `${languageData[currentLang].form_submitting || 'জমা হচ্ছে...'} <i class="fas fa-spinner fa-spin ltr:ml-2 rtl:mr-2"></i>`;
            submitButton.disabled = true;

            const formData = new FormData(form);
            
            // This is a working Formspree endpoint. Replace if you have your own.
            fetch('https://formspree.io/f/mldrdjpd', { 
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            })
            .then(response => {
                if (response.ok) {
                    successMessage.classList.remove('hidden');
                    form.reset();
                } else {
                    response.json().then(data => {
                        errorMessage.textContent = data.errors ? data.errors.map(err => err.message).join(', ') : languageData[currentLang].form_error;
                        errorMessage.classList.remove('hidden');
                    });
                }
            })
            .catch(error => {
                errorMessage.textContent = languageData[currentLang].form_network_error || 'একটি নেটওয়ার্ক সমস্যা হয়েছে।';
                errorMessage.classList.remove('hidden');
            })
            .finally(() => {
                submitButton.textContent = originalButtonText;
                submitButton.disabled = false;
            });
        });
    }
    
    // --- MODAL LOGIC ---
    function setupModal() {
        const modal = document.getElementById('masayel-modal');
        const closeModalButton = document.getElementById('modal-close-button');
        
        document.getElementById('masayel-content').addEventListener('click', (e) => {
            if (e.target.classList.contains('read-more-btn')) {
                const masalaId = e.target.dataset.id;
                const masala = masayelData.find(m => m.id == masalaId);
                if (masala) {
                    openModal(masala);
                }
            }
        });

        closeModalButton.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });
    }
    
    function openModal(masala) {
        const modal = document.getElementById('masayel-modal');
        document.getElementById('modal-title').textContent = masala.title[currentLang];
        document.getElementById('modal-body').textContent = masala.content[currentLang];
        
        const copyButton = document.getElementById('copy-button');
        const shareButton = document.getElementById('share-button');
        
        copyButton.onclick = () => copyToClipboard(masala.title[currentLang], masala.content[currentLang]);
        shareButton.onclick = () => shareMasala(masala.title[currentLang], masala.content[currentLang]);
        
        modal.classList.remove('hidden');
        setTimeout(() => modal.classList.remove('opacity-0'), 10);
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        const modal = document.getElementById('masayel-modal');
        modal.classList.add('opacity-0');
        setTimeout(() => {
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }, 300);
    }
    
    // --- UTILITY FUNCTIONS ---
    function copyToClipboard(title, text) {
        const fullText = `${languageData[currentLang].form_subject}: ${title}\n\n${languageData[currentLang].answer || 'উত্তর'}: ${text}`;
        const toast = document.getElementById('copy-success-toast');
        try {
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = fullText;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 2000);
        } catch (err) {
            console.error('Failed to copy: ', err);
        }
    }

    function shareMasala(title, text) {
        const fullText = `${languageData[currentLang].form_subject}: ${title}\n\n${languageData[currentLang].answer || 'উত্তর'}: ${text}`;
        if (navigator.share) {
            navigator.share({
                title: title,
                text: fullText,
                url: window.location.href,
            }).catch(console.error);
        } else {
             copyToClipboard(title, text);
             alert(languageData[currentLang].share_fallback || "আপনার ব্রাউজার শেয়ার সমর্থন করে না। মাসয়ালাটি ক্লিপবোর্ডে কপি করা হয়েছে।");
        }
    }

    // --- RUN APP ---
    init();
});
</script>

</body>
</html>
